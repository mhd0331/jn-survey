<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì§„ì•ˆêµ° ì„¤ë¬¸ì¡°ì‚¬</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', Arial, sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 400px;
            font-size: 18px;
            color: #666;
        }

        .header {
            background: linear-gradient(135deg, #2c5aa0 0%, #1e3a5f 100%);
            color: white;
            padding: 40px 30px;
            text-align: center;
            position: relative;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="pattern" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse"><circle cx="10" cy="10" r="1" fill="rgba(255,255,255,0.1)"/></pattern></defs><rect width="100" height="100" fill="url(%23pattern)"/></svg>');
        }

        .header-content {
            position: relative;
            z-index: 1;
        }

        .logo {
            width: 80px;
            height: 80px;
            background: white;
            border-radius: 50%;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            color: #2c5aa0;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 16px;
            opacity: 0.9;
            margin-bottom: 20px;
        }

        .survey-info {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .survey-info div {
            display: inline-block;
            margin: 0 15px;
            font-size: 14px;
        }

        .content {
            padding: 40px 30px;
        }

        .welcome-section {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 5px solid #2c5aa0;
        }

        .welcome-section h2 {
            color: #2c5aa0;
            margin-bottom: 15px;
            font-size: 22px;
        }

        .welcome-section p {
            color: #555;
            margin-bottom: 10px;
        }

        .section {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            margin-bottom: 30px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .section:hover {
            border-color: #2c5aa0;
            box-shadow: 0 5px 15px rgba(44, 90, 160, 0.1);
        }

        .section-header {
            background: linear-gradient(135deg, #2c5aa0, #1e3a5f);
            color: white;
            padding: 20px;
            font-size: 18px;
            font-weight: 600;
        }

        .section-content {
            padding: 25px;
        }

        .question {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #2c5aa0;
        }

        .question.conditional {
            display: none;
            border-left-color: #ffc107;
            background: #fff8e1;
        }

        .question-label {
            font-weight: 600;
            margin-bottom: 15px;
            color: #333;
            font-size: 16px;
            line-height: 1.5;
        }

        .required {
            color: #dc3545;
            margin-left: 5px;
        }

        .help-text {
            font-size: 14px;
            color: #666;
            margin-bottom: 15px;
            font-style: italic;
        }

        .form-control {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: #2c5aa0;
            box-shadow: 0 0 0 3px rgba(44, 90, 160, 0.1);
        }

        .radio-group, .checkbox-group {
            display: grid;
            gap: 12px;
        }

        .radio-item, .checkbox-item {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .radio-item:hover, .checkbox-item:hover {
            border-color: #2c5aa0;
            background: #f8f9fa;
        }

        .radio-item input, .checkbox-item input {
            margin-right: 12px;
            transform: scale(1.2);
        }

        .scale-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 10px;
            margin: 20px 0;
        }

        .scale-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
        }

        .scale-radio {
            width: 20px;
            height: 20px;
            margin-bottom: 8px;
        }

        .scale-label {
            font-size: 12px;
            text-align: center;
            color: #666;
            line-height: 1.3;
        }

        .matrix-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .matrix-table th {
            background: #2c5aa0;
            color: white;
            padding: 15px 10px;
            text-align: center;
            font-size: 13px;
            font-weight: 600;
        }

        .matrix-table td {
            padding: 15px 10px;
            text-align: center;
            border-bottom: 1px solid #e9ecef;
        }

        .matrix-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .matrix-table tr:hover {
            background: #e3f2fd;
        }

        .matrix-row-label {
            text-align: left !important;
            font-weight: 500;
            color: #333;
            background: #f8f9fa !important;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #2c5aa0, #667eea);
            border-radius: 4px;
            transition: width 0.3s ease;
            width: 0%;
        }

        .button-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 40px 0;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 120px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #2c5aa0, #1e3a5f);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(44, 90, 160, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        .thank-you {
            display: none;
            text-align: center;
            padding: 60px 30px;
        }

        .thank-you h2 {
            color: #2c5aa0;
            font-size: 28px;
            margin-bottom: 20px;
        }

        .thank-you p {
            font-size: 16px;
            color: #666;
            margin-bottom: 15px;
        }

        .check-icon {
            width: 80px;
            height: 80px;
            background: #28a745;
            border-radius: 50%;
            margin: 0 auto 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            color: white;
            animation: checkmark 0.6s ease-in-out;
        }

        @keyframes checkmark {
            0% { transform: scale(0); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .footer {
            background: #2c5aa0;
            color: white;
            text-align: center;
            padding: 20px;
            font-size: 14px;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 10px;
            }

            .header, .content {
                padding: 20px;
            }

            .header h1 {
                font-size: 24px;
            }

            .survey-info div {
                display: block;
                margin: 5px 0;
            }

            .scale-container {
                flex-direction: column;
                gap: 15px;
            }

            .scale-item {
                flex-direction: row;
                justify-content: space-between;
                padding: 10px;
                background: white;
                border-radius: 5px;
                border: 1px solid #ddd;
            }

            .matrix-table {
                font-size: 12px;
            }

            .matrix-table th, .matrix-table td {
                padding: 8px 5px;
            }

            .button-group {
                flex-direction: column;
                align-items: center;
            }
        }

        .error-message {
            color: #dc3545;
            font-size: 14px;
            margin-top: 5px;
            display: none;
        }

        .question.error .form-control {
            border-color: #dc3545;
        }

        .question.error .error-message {
            display: block;
        }

        .error {
            border-color: #dc3545 !important;
            background: #ffe6e6 !important;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="loading" id="loading">
            ì„¤ë¬¸ì¡°ì‚¬ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
        </div>

        <div id="surveyContainer" style="display: none;">
            <div class="header">
                <div class="header-content">
                    <div class="logo">ì§„ì•ˆ</div>
                    <h1 id="surveyTitle">ì„¤ë¬¸ì¡°ì‚¬</h1>
                    <p id="surveyDescription">ì„¤ë¬¸ì¡°ì‚¬ ì„¤ëª…</p>
                    <div class="survey-info" id="surveyInfo">
                        <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
                    </div>
                </div>
            </div>

            <div class="content">
                <div class="welcome-section" id="welcomeSection">
                    <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
                </div>

                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>

                <form id="surveyForm">
                    <div id="sectionsContainer">
                        <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
                    </div>

                    <div class="button-group">
                        <button type="button" class="btn btn-secondary" onclick="resetForm()">ì´ˆê¸°í™”</button>
                        <button type="submit" class="btn btn-primary">ì„¤ë¬¸ ì œì¶œ</button>
                    </div>
                </form>

                <div class="thank-you" id="thankYou">
                    <div class="check-icon">âœ“</div>
                    <div id="thankYouContent">
                        <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
                    </div>
                </div>
            </div>

            <div class="footer">
                Â© 2025 ì§„ì•ˆêµ°ì²­. ëª¨ë“  ê¶Œë¦¬ ë³´ìœ . | ë¬¸ì˜: 063-430-8000 | ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨
            </div>
        </div>
    </div>

    <script>
        let surveyData = null;
        let conditionalQuestions = {};

        // JSON ë°ì´í„° ë¡œë“œ
        async function loadSurveyData() {
            try {
                // ì‹¤ì œ í™˜ê²½ì—ì„œëŠ” ì„œë²„ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜´
                // const response = await fetch('survey-data.json');
                // const data = await response.json();
                
                // ë°ëª¨ë¥¼ ìœ„í•´ ìƒ˜í”Œ ë°ì´í„° ì‚¬ìš© (ì‹¤ì œë¡œëŠ” ìœ„ì˜ fetch ì½”ë“œ ì‚¬ìš©)
                const data = await getSampleData();
                surveyData = data;
                
                buildSurvey(data);
                document.getElementById('loading').style.display = 'none';
                document.getElementById('surveyContainer').style.display = 'block';
                
                initializeEventListeners();
            } catch (error) {
                console.error('ì„¤ë¬¸ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                document.getElementById('loading').innerHTML = 'ì„¤ë¬¸ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
            }
        }

        // ì„¤ë¬¸ì¡°ì‚¬ UI êµ¬ì„±
        function buildSurvey(data) {
            // í—¤ë” ì •ë³´ ì„¤ì •
            document.getElementById('surveyTitle').textContent = data.survey.title;
            document.getElementById('surveyDescription').textContent = data.survey.description;
            
            // ì„¤ë¬¸ ì •ë³´ ìƒì„±
            const surveyInfo = document.getElementById('surveyInfo');
            surveyInfo.innerHTML = `
                <div>ğŸ“… ì¡°ì‚¬ê¸°ê°„: ${data.survey.period.start} ~ ${data.survey.period.end}</div>
                <div>â±ï¸ ì†Œìš”ì‹œê°„: ì•½ ${data.survey.estimatedTime}ë¶„</div>
                <div>ğŸ¯ ëª©í‘œ ì‘ë‹µ: ${data.survey.maxResponses.toLocaleString()}ëª…</div>
            `;

            // í™˜ì˜ ë©”ì‹œì§€ ìƒì„±
            const welcomeSection = document.getElementById('welcomeSection');
            const welcome = data.survey.welcomeMessage;
            welcomeSection.innerHTML = `
                <h2>${welcome.title}</h2>
                ${welcome.content.map(p => `<p>${p}</p>`).join('')}
            `;

            // ê°ì‚¬ ë©”ì‹œì§€ ìƒì„±
            const thankYouContent = document.getElementById('thankYouContent');
            const thankYou = data.survey.thankYouMessage;
            thankYouContent.innerHTML = `
                <h2>${thankYou.title}</h2>
                ${thankYou.content.map(p => `<p><strong>${p}</strong></p>`).join('')}
            `;

            // ì„¹ì…˜ê³¼ ì§ˆë¬¸ ìƒì„±
            buildSections(data);
        }

        // ì„¹ì…˜ êµ¬ì„±
        function buildSections(data) {
            const sectionsContainer = document.getElementById('sectionsContainer');
            const sections = data.sections.sort((a, b) => a.order - b.order);
            
            sections.forEach(section => {
                const sectionElement = createSectionElement(section, data.questions);
                sectionsContainer.appendChild(sectionElement);
            });
        }

        // ì„¹ì…˜ ìš”ì†Œ ìƒì„±
        function createSectionElement(section, questions) {
            const sectionDiv = document.createElement('div');
            sectionDiv.className = 'section';
            sectionDiv.innerHTML = `
                <div class="section-header">
                    ${section.title} (${section.description})
                </div>
                <div class="section-content" id="section-${section.id}">
                </div>
            `;

            const sectionContent = sectionDiv.querySelector('.section-content');
            const sectionQuestions = questions
                .filter(q => q.sectionId === section.id)
                .sort((a, b) => a.order - b.order);

            sectionQuestions.forEach(question => {
                const questionElement = createQuestionElement(question);
                sectionContent.appendChild(questionElement);
            });

            return sectionDiv;
        }

        // ì§ˆë¬¸ ìš”ì†Œ ìƒì„±
        function createQuestionElement(question) {
            const questionDiv = document.createElement('div');
            questionDiv.className = `question ${question.conditional ? 'conditional' : ''}`;
            questionDiv.id = `question-${question.id}`;
            questionDiv.dataset.required = question.required;
            questionDiv.dataset.questionId = question.id;

            let questionHTML = `
                <div class="question-label">
                    ${question.order}. ${question.text}
                    ${question.required ? '<span class="required">*</span>' : ''}
                </div>
            `;

            if (question.helpText) {
                questionHTML += `<div class="help-text">${question.helpText}</div>`;
            }

            // ì§ˆë¬¸ íƒ€ì…ì— ë”°ë¥¸ ì…ë ¥ ìš”ì†Œ ìƒì„±
            switch (question.type) {
                case 'radio':
                    questionHTML += createRadioGroup(question);
                    break;
                case 'checkbox':
                    questionHTML += createCheckboxGroup(question);
                    break;
                case 'dropdown':
                    questionHTML += createDropdown(question);
                    break;
                case 'scale':
                    questionHTML += createScale(question);
                    break;
                case 'matrix':
                    questionHTML += createMatrix(question);
                    break;
                case 'textarea':
                    questionHTML += createTextarea(question);
                    break;
                default:
                    questionHTML += createTextInput(question);
            }

            questionHTML += '<div class="error-message">ì´ í•­ëª©ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.</div>';
            questionDiv.innerHTML = questionHTML;

            // ì¡°ê±´ë¶€ ë¡œì§ ì„¤ì •
            if (question.conditionalLogic) {
                conditionalQuestions[question.id] = question.conditionalLogic;
            }

            return questionDiv;
        }

        // ë¼ë””ì˜¤ ê·¸ë£¹ ìƒì„±
        function createRadioGroup(question) {
            const options = question.options.sort((a, b) => a.order - b.order);
            return `
                <div class="radio-group">
                    ${options.map(option => `
                        <label class="radio-item">
                            <input type="radio" name="${question.id}" value="${option.value}" ${question.required ? 'required' : ''}>
                            ${option.text}
                        </label>
                    `).join('')}
                </div>
            `;
        }

        // ì²´í¬ë°•ìŠ¤ ê·¸ë£¹ ìƒì„±
        function createCheckboxGroup(question) {
            const options = question.options.sort((a, b) => a.order - b.order);
            return `
                <div class="checkbox-group">
                    ${options.map(option => `
                        <label class="checkbox-item">
                            <input type="checkbox" name="${question.id}" value="${option.value}">
                            ${option.text}
                        </label>
                    `).join('')}
                </div>
            `;
        }

        // ë“œë¡­ë‹¤ìš´ ìƒì„±
        function createDropdown(question) {
            const options = question.options.sort((a, b) => a.order - b.order);
            return `
                <select name="${question.id}" class="form-control" ${question.required ? 'required' : ''}>
                    <option value="">${question.placeholder || 'ì„ íƒí•´ ì£¼ì„¸ìš”'}</option>
                    ${options.map(option => `
                        <option value="${option.value}">${option.text}</option>
                    `).join('')}
                </select>
            `;
        }

        // ì²™ë„ ìƒì„±
        function createScale(question) {
            const config = question.scaleConfig;
            let scaleHTML = '<div class="scale-container">';
            
            for (let i = config.min; i <= config.max; i++) {
                scaleHTML += `
                    <div class="scale-item">
                        <input type="radio" name="${question.id}" value="${i}" class="scale-radio" ${question.required ? 'required' : ''}>
                        <div class="scale-label">${config.labels[i] || i}</div>
                    </div>
                `;
            }
            
            scaleHTML += '</div>';
            return scaleHTML;
        }

        // ë§¤íŠ¸ë¦­ìŠ¤ ìƒì„±
        function createMatrix(question) {
            const config = question.matrixConfig;
            let matrixHTML = `
                <table class="matrix-table">
                    <thead>
                        <tr>
                            <th>ì •ì±… ë¶„ì•¼</th>
                            ${config.columns.map(col => `<th>${col.text}</th>`).join('')}
                        </tr>
                    </thead>
                    <tbody>
            `;

            config.rows.forEach(row => {
                matrixHTML += `
                    <tr>
                        <td class="matrix-row-label">${row.text}</td>
                        ${config.columns.map(col => `
                            <td><input type="radio" name="${row.id}" value="${col.value}" ${question.required ? 'required' : ''}></td>
                        `).join('')}
                    </tr>
                `;
            });

            matrixHTML += '</tbody></table>';
            return matrixHTML;
        }

        // í…ìŠ¤íŠ¸ ì˜ì—­ ìƒì„±
        function createTextarea(question) {
            return `
                <textarea 
                    name="${question.id}" 
                    class="form-control" 
                    rows="${question.rows || 4}"
                    placeholder="${question.placeholder || ''}"
                    ${question.required ? 'required' : ''}
                ></textarea>
            `;
        }

        // í…ìŠ¤íŠ¸ ì…ë ¥ ìƒì„±
        function createTextInput(question) {
            return `
                <input 
                    type="text" 
                    name="${question.id}" 
                    class="form-control"
                    placeholder="${question.placeholder || ''}"
                    ${question.required ? 'required' : ''}
                >
            `;
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì´ˆê¸°í™”
        function initializeEventListeners() {
            const form = document.getElementById('surveyForm');
            
            // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
            form.addEventListener('change', updateProgress);
            form.addEventListener('input', updateProgress);

            // ì¡°ê±´ë¶€ ë¡œì§ ì²˜ë¦¬
            form.addEventListener('change', handleConditionalLogic);

            // í¼ ì œì¶œ
            form.addEventListener('submit', handleFormSubmit);

            // ì´ˆê¸° ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
            updateProgress();
        }

        // ì¡°ê±´ë¶€ ë¡œì§ ì²˜ë¦¬
        function handleConditionalLogic(event) {
            const questionId = event.target.name;
            const value = event.target.value;

            // digital_skills ì§ˆë¬¸ì˜ ì¡°ê±´ë¶€ ë¡œì§
            if (questionId === 'digital_skills') {
                const digitalSupportQuestion = document.getElementById('question-digital_support');
                if (digitalSupportQuestion) {
                    if (parseInt(value) < 3) {
                        digitalSupportQuestion.style.display = 'block';
                    } else {
                        digitalSupportQuestion.style.display = 'none';
                    }
                }
            }
        }

        // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
        function updateProgress() {
            const form = document.getElementById('surveyForm');
            const allQuestions = surveyData.questions.filter(q => !q.conditional);
            const requiredQuestions = allQuestions.filter(q => q.required);
            
            let completedCount = 0;
            
            requiredQuestions.forEach(question => {
                const inputs = form.querySelectorAll(`[name="${question.id}"]`);
                let isCompleted = false;

                if (question.type === 'radio' || question.type === 'scale') {
                    isCompleted = Array.from(inputs).some(input => input.checked);
                } else if (question.type === 'checkbox') {
                    isCompleted = Array.from(inputs).some(input => input.checked);
                } else if (question.type === 'matrix') {
                    const matrixRows = question.matrixConfig.rows;
                    isCompleted = matrixRows.every(row => {
                        const rowInputs = form.querySelectorAll(`[name="${row.id}"]`);
                        return Array.from(rowInputs).some(input => input.checked);
                    });
                } else {
                    isCompleted = inputs[0] && inputs[0].value.trim() !== '';
                }

                if (isCompleted) completedCount++;
            });

            const progress = (completedCount / requiredQuestions.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        // í¼ ê²€ì¦
        function validateForm() {
            const form = document.getElementById('surveyForm');
            let isValid = true;

            // ëª¨ë“  ì˜¤ë¥˜ ìŠ¤íƒ€ì¼ ì œê±°
            document.querySelectorAll('.question.error').forEach(q => q.classList.remove('error'));

            surveyData.questions.forEach(question => {
                if (!question.required || question.conditional) return;

                const questionDiv = document.getElementById(`question-${question.id}`);
                if (!questionDiv || questionDiv.style.display === 'none') return;

                let isQuestionValid = true;

                if (question.type === 'radio' || question.type === 'scale') {
                    const inputs = form.querySelectorAll(`[name="${question.id}"]`);
                    isQuestionValid = Array.from(inputs).some(input => input.checked);
                } else if (question.type === 'checkbox') {
                    const inputs = form.querySelectorAll(`[name="${question.id}"]`);
                    isQuestionValid = Array.from(inputs).some(input => input.checked);
                } else if (question.type === 'matrix') {
                    const matrixRows = question.matrixConfig.rows;
                    isQuestionValid = matrixRows.every(row => {
                        const rowInputs = form.querySelectorAll(`[name="${row.id}"]`);
                        return Array.from(rowInputs).some(input => input.checked);
                    });
                } else {
                    const input = form.querySelector(`[name="${question.id}"]`);
                    isQuestionValid = input && input.value.trim() !== '';
                }

                if (!isQuestionValid) {
                    questionDiv.classList.add('error');
                    isValid = false;
                }
            });

            return isValid;
        }

        // í¼ ì œì¶œ ì²˜ë¦¬
        function handleFormSubmit(event) {
            event.preventDefault();

            if (!validateForm()) {
                alert('í•„ìˆ˜ í•­ëª©ì„ ëª¨ë‘ ì…ë ¥í•´ ì£¼ì„¸ìš”.');
                const firstError = document.querySelector('.question.error');
                if (firstError) {
                    firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
                return;
            }

            // ë°ì´í„° ìˆ˜ì§‘
            const formData = new FormData(event.target);
            const responseData = {};

            // ì¼ë°˜ í•„ë“œ ì²˜ë¦¬
            for (let [key, value] of formData.entries()) {
                if (responseData[key]) {
                    if (Array.isArray(responseData[key])) {
                        responseData[key].push(value);
                    } else {
                        responseData[key] = [responseData[key], value];
                    }
                } else {
                    responseData[key] = value;
                }
            }

            // ì²´í¬ë°•ìŠ¤ ê·¸ë£¹ ì²˜ë¦¬
            const checkboxQuestions = surveyData.questions.filter(q => q.type === 'checkbox');
            checkboxQuestions.forEach(question => {
                const checked = Array.from(document.querySelectorAll(`input[name="${question.id}"]:checked`))
                    .map(cb => cb.value);
                responseData[question.id] = checked;
            });

            console.log('ì„¤ë¬¸ ì‘ë‹µ ë°ì´í„°:', responseData);

            // ì„±ê³µ í™”ë©´ í‘œì‹œ
            document.querySelector('.content').style.display = 'none';
            document.getElementById('thankYou').style.display = 'block';

            // ì‹¤ì œ í™˜ê²½ì—ì„œëŠ” ì„œë²„ë¡œ ë°ì´í„° ì „ì†¡
            // submitToServer(responseData);
        }

        // í¼ ì´ˆê¸°í™”
        function resetForm() {
            if (confirm('ëª¨ë“  ì…ë ¥ ë‚´ìš©ì´ ì‚­ì œë©ë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                document.getElementById('surveyForm').reset();
                document.querySelectorAll('.question.error').forEach(q => q.classList.remove('error'));
                document.querySelectorAll('.question.conditional').forEach(q => q.style.display = 'none');
                updateProgress();
            }
        }

        // ì„œë²„ë¡œ ë°ì´í„° ì „ì†¡
        async function submitToServer(responseData) {
            try {
                const response = await fetch('/api/surveys/submit', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        surveyId: surveyData.survey.id,
                        responses: responseData,
                        timestamp: new Date().toISOString()
                    })
                });

                if (!response.ok) {
                    throw new Error('ì„œë²„ ì „ì†¡ ì‹¤íŒ¨');
                }

                const result = await response.json();
                console.log('ì„œë²„ ì‘ë‹µ:', result);
            } catch (error) {
                console.error('ë°ì´í„° ì „ì†¡ ì˜¤ë¥˜:', error);
                alert('ì‘ë‹µ ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.');
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
        document.addEventListener('DOMContentLoaded', loadSurveyData);

        // ìƒ˜í”Œ ë°ì´í„° (ì‹¤ì œë¡œëŠ” survey-data.jsonì—ì„œ ë¡œë“œ)
        async function getSampleData() {
            // ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” ì´ í•¨ìˆ˜ë¥¼ ì œê±°í•˜ê³  ì•„ë˜ ì½”ë“œë¥¼ ì‚¬ìš©:
            // const response = await fetch('survey-data.json');
            // return await response.json();
            
            return new Promise(resolve => {
                setTimeout(() => {
                    resolve({
                        "survey": {
                            "id": "jinan-policy-survey-2025",
                            "title": "ì§„ì•ˆêµ° í–‰ì •ì •ì±… ì…ì•ˆ ì‹œ ëŒ€ê·œëª¨ ì—¬ë¡ ì¡°ì‚¬ í•„ìš”ì„± ì¡°ì‚¬",
                            "description": "ì§„ì•ˆêµ°ì—ì„œ í–‰ì •ì •ì±…ì„ ìˆ˜ë¦½í•  ë•Œ í•¸ë“œí°ì´ë‚˜ ì»´í“¨í„°ë¥¼ í™œìš©í•œ ëŒ€ê·œëª¨ ì—¬ë¡ ì¡°ì‚¬ì˜ í•„ìš”ì„±ê³¼ íš¨ê³¼ì„±ì— ëŒ€í•œ êµ°ë¯¼ ì˜ê²¬ì„ ìˆ˜ë ´í•˜ëŠ” ì„¤ë¬¸ì¡°ì‚¬ì…ë‹ˆë‹¤.",
                            "estimatedTime": 7,
                            "maxResponses": 10000,
                            "period": {
                                "start": "2025.07.21",
                                "end": "2025.08.20"
                            },
                            "welcomeMessage": {
                                "title": "ì•ˆë…•í•˜ì„¸ìš”, ì§„ì•ˆêµ°ì…ë‹ˆë‹¤.",
                                "content": [
                                    "ë³¸ ì„¤ë¬¸ì¡°ì‚¬ëŠ” ì§„ì•ˆêµ°ì˜ í–‰ì •ì •ì±… ìˆ˜ë¦½ ê³¼ì •ì—ì„œ ë””ì§€í„¸ ê¸°ë°˜ ì—¬ë¡ ì¡°ì‚¬ ë„ì…ì— ëŒ€í•œ êµ°ë¯¼ ì—¬ëŸ¬ë¶„ì˜ ì†Œì¤‘í•œ ì˜ê²¬ì„ ë“£ê³ ì ì‹¤ì‹œë©ë‹ˆë‹¤.",
                                    "ì—¬ëŸ¬ë¶„ì˜ ì°¸ì—¬ê°€ ë” ë‚˜ì€ ì§„ì•ˆêµ°ì„ ë§Œë“œëŠ” ë° í° ë„ì›€ì´ ë©ë‹ˆë‹¤.",
                                    "â€» ëª¨ë“  ì‘ë‹µì€ í†µê³„ ëª©ì ìœ¼ë¡œë§Œ ì‚¬ìš©ë˜ë©°, ê°œì¸ì •ë³´ëŠ” ì² ì €íˆ ë³´í˜¸ë©ë‹ˆë‹¤."
                                ]
                            },
                            "thankYouMessage": {
                                "title": "ì„¤ë¬¸ì¡°ì‚¬ ì™„ë£Œ",
                                "content": [
                                    "ì„¤ë¬¸ì¡°ì‚¬ì— ì°¸ì—¬í•´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤.",
                                    "ì—¬ëŸ¬ë¶„ì˜ ì†Œì¤‘í•œ ì˜ê²¬ì€ ì§„ì•ˆêµ°ì˜ ì •ì±… ìˆ˜ë¦½ì— ë°˜ì˜ë  ì˜ˆì •ì…ë‹ˆë‹¤.",
                                    "ë” ë‚˜ì€ ì§„ì•ˆêµ°ì„ ìœ„í•´ í•¨ê»˜í•´ ì£¼ì„¸ìš”!"
                                ]
                            }
                        },
                        "sections": [
                            {
                                "id": "demographics",
                                "title": "ğŸ“ 1. ì‘ë‹µì ê¸°ë³¸ì •ë³´",
                                "description": "í†µê³„ ë¶„ì„ì„ ìœ„í•œ ê¸°ë³¸ì ì¸ ì •ë³´ë¥¼ ìˆ˜ì§‘í•©ë‹ˆë‹¤",
                                "order": 1
                            },
                            {
                                "id": "policy_participation",
                                "title": "ğŸ›ï¸ 2. í˜„ì¬ ì •ì±… ì°¸ì—¬ í˜„í™©",
                                "description": "ì§„ì•ˆêµ° ì •ì±…ì— ëŒ€í•œ í˜„ì¬ ì°¸ì—¬ë„ì™€ ê´€ì‹¬ë„ë¥¼ ì¡°ì‚¬í•©ë‹ˆë‹¤",
                                "order": 2
                            },
                            {
                                "id": "digital_perception",
                                "title": "ğŸ’» 3. ë””ì§€í„¸ ì—¬ë¡ ì¡°ì‚¬ì— ëŒ€í•œ ì¸ì‹",
                                "description": "í•¸ë“œí°/ì»´í“¨í„°ë¥¼ í™œìš©í•œ ì—¬ë¡ ì¡°ì‚¬ì— ëŒ€í•œ ìƒê°ì„ ì¡°ì‚¬í•©ë‹ˆë‹¤",
                                "order": 3
                            }
                        ],
                        "questions": [
                            {
                                "id": "gender",
                                "sectionId": "demographics",
                                "order": 1,
                                "text": "ê·€í•˜ì˜ ì„±ë³„ì€ ë¬´ì—‡ì…ë‹ˆê¹Œ?",
                                "type": "radio",
                                "required": true,
                                "helpText": "í†µê³„ ë¶„ì„ì„ ìœ„í•œ ì •ë³´ì…ë‹ˆë‹¤.",
                                "options": [
                                    { "value": "male", "text": "ë‚¨ì„±", "order": 1 },
                                    { "value": "female", "text": "ì—¬ì„±", "order": 2 },
                                    { "value": "other", "text": "ê¸°íƒ€", "order": 3 },
                                    { "value": "prefer_not_to_say", "text": "ì‘ë‹µí•˜ì§€ ì•ŠìŒ", "order": 4 }
                                ]
                            },
                            {
                                "id": "age",
                                "sectionId": "demographics",
                                "order": 2,
                                "text": "ê·€í•˜ì˜ ì—°ë ¹ëŒ€ëŠ” ì–´ë–»ê²Œ ë©ë‹ˆê¹Œ?",
                                "type": "radio",
                                "required": true,
                                "options": [
                                    { "value": "under_20", "text": "20ì„¸ ë¯¸ë§Œ", "order": 1 },
                                    { "value": "20s", "text": "20-29ì„¸", "order": 2 },
                                    { "value": "30s", "text": "30-39ì„¸", "order": 3 },
                                    { "value": "40s", "text": "40-49ì„¸", "order": 4 },
                                    { "value": "50s", "text": "50-59ì„¸", "order": 5 },
                                    { "value": "60s", "text": "60-69ì„¸", "order": 6 },
                                    { "value": "over_70", "text": "70ì„¸ ì´ìƒ", "order": 7 }
                                ]
                            },
                            {
                                "id": "digital_skills",
                                "sectionId": "digital_perception",
                                "order": 8,
                                "text": "ê·€í•˜ì˜ ìŠ¤ë§ˆíŠ¸í°/ì»´í“¨í„° í™œìš© ëŠ¥ë ¥ì€ ì–´ëŠ ì •ë„ì…ë‹ˆê¹Œ?",
                                "type": "scale",
                                "required": true,
                                "scaleConfig": {
                                    "min": 1,
                                    "max": 5,
                                    "labels": {
                                        "1": "ë§¤ìš° ì„œíˆ¼",
                                        "2": "ì„œíˆ¼",
                                        "3": "ë³´í†µ",
                                        "4": "ëŠ¥ìˆ™",
                                        "5": "ë§¤ìš° ëŠ¥ìˆ™"
                                    }
                                }
                            },
                            {
                                "id": "digital_support",
                                "sectionId": "digital_perception",
                                "order": 8.5,
                                "text": "ìŠ¤ë§ˆíŠ¸í°/ì»´í“¨í„° ì‚¬ìš©ì´ ì–´ë ¤ìš°ì‹œë‹¤ë©´, ì–´ë–¤ ì§€ì›ì´ ìˆìœ¼ë©´ ë„ì›€ì´ ë ê¹Œìš”?",
                                "type": "checkbox",
                                "required": false,
                                "helpText": "í•´ë‹¹ë˜ëŠ” ëª¨ë“  í•­ëª©ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.",
                                "conditional": true,
                                "options": [
                                    { "value": "family_help", "text": "ê°€ì¡±/ì§€ì¸ì˜ ë„ì›€", "order": 1 },
                                    { "value": "community_center", "text": "ë™ë„¤ ì§€ì›ì„¼í„°", "order": 2 },
                                    { "value": "phone_support", "text": "ì „í™” ìƒë‹´ ì„œë¹„ìŠ¤", "order": 3 },
                                    { "value": "home_education", "text": "ë°©ë¬¸ êµìœ¡ ì„œë¹„ìŠ¤", "order": 4 },
                                    { "value": "simple_manual", "text": "ê°„ë‹¨í•œ ì‚¬ìš©ë²• ì•ˆë‚´ì„œ", "order": 5 },
                                    { "value": "no_help_needed", "text": "ë„ì›€ì´ í•„ìš”í•˜ì§€ ì•ŠìŒ", "order": 6 }
                                ]
                            }
                        ]
                    });
                }, 1000);
            });
        }